<html><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CryptoFans - Timeline and Chats</title>
	<meta name="description" content="CryptoFans - Create and Share Content with any Token on Polygon network">
	<meta name="img" content="https://cryptofans.io/img/preview.png">
  <meta property="og:image" content="https://cryptofans.io/img/preview.png">
  <meta name="twitter:image" content="https://cryptofans.io/img/preview.png">
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;600&amp;display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.5.2/web3.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.13.2/ethers.umd.min.js"></script>
  <script src="https://exdc.cc/sdk.js" type="module"></script>
  <link rel="stylesheet" href="/styles/styles.css">
  <link rel="stylesheet" href="/styles/dashboard.css">
  <script src="/anim.js"></script>
</head>
<body>
  <embed type="text/html" src="/components/nav.html" class="embed-nav">
  <div class="container">
    <div class="sidebar">
      <h2 class="hidden-on-mobile">Subscriptions</h2>
      <ul class="chat-list">
        <!-- Chat list will be dynamically inserted here -->
      </ul>
      <h2 style="display: none;">Your Followers</h2>
      <ul style="display: none;" class="followers-list">
        <!-- Followers list will be dynamically inserted here -->
      </ul>
    </div>
    <div class="main-content">
      <div class="timeline">
        <!-- Posts will be dynamically inserted here -->
      </div>
    </div>
  </div>

  <div id="animation-container"></div>
  <embed type="text/html" src="/components/footer.html" class="embed-footer">

  <script>
    const posts = [
      {
        creator: {
          name: "PixelMaster",
          avatar: "/img/pixelmaster.webp"
        },
        timestamp: "2023-05-15T14:30:00",
        content: "Just finished my latest pixel art piece! What do you think?",
        image: "/img/pixel1.webp",
        likes: 256,
        comments: 42,
        price: 50
      },
      {
        creator: {
          name: "MusicMaven",
          avatar: "/img/musicmaven.webp"
        },
        timestamp: "2023-05-15T12:15:00",
        content: "New track dropping tomorrow! Get ready for some sick beats ðŸŽµ",
        likes: 189,
        comments: 31,
        price: 25
      },
      {
        creator: {
          name: "CryptoQueen",
          avatar: "/img/cryptoqueen.webp"
        },
        timestamp: "2023-05-15T10:00:00",
        content: "Just acquired this amazing NFT for my collection. The detail is mind-blowing!",
        image: "/img/nft1.webp",
        likes: 412,
        comments: 73,
        price: 100
      },
      {
        creator: {
          name: "VirtualVoyager",
          avatar: "/img/virtualvoyager.webp"
        },
        timestamp: "2023-05-14T22:45:00",
        content: "Sneak peek of my latest VR experience. Prepare to be transported to another world!",
        image: "/img/vr1.webp",
        likes: 301,
        comments: 58,
        price: 75
      },
      {
        creator: {
          name: "CodeCrafter",
          avatar: "/img/codecrafter.webp"
        },
        timestamp: "2023-05-14T20:30:00",
        content: "Just pushed a major update to my smart contract library. Check it out on GitHub!",
        likes: 178,
        comments: 29,
        price: 40
      }
    ];

    const chats = [
      { name: "PixelMaster", avatar: "/img/pixelmaster.webp", lastMessage: "Thanks for the feedback!" },
      { name: "MusicMaven", avatar: "/img/musicmaven.webp", lastMessage: "Can't wait for you to hear it!" },
      { name: "CryptoQueen", avatar: "/img/cryptoqueen.webp", lastMessage: "Let's collab on an NFT project" },
      { name: "VirtualVoyager", avatar: "/img/virtualvoyager.webp", lastMessage: "The beta version is ready" },
      { name: "CodeCrafter", avatar: "/img/codecrafter.webp", lastMessage: "Check out this new function" }
    ];

    const followers = [
      { name: "CryptoEnthusiast", avatar: "avatars/follower1.jpg" },
      { name: "ArtLover", avatar: "avatars/follower2.jpg" },
      { name: "TechGuru", avatar: "avatars/follower3.jpg" },
      { name: "MusicFan", avatar: "avatars/follower4.jpg" },
      { name: "NFTCollector", avatar: "avatars/follower5.jpg" }
    ];

    const timeline = document.querySelector('.timeline');
    const chatList = document.querySelector('.chat-list');
    const followersList = document.querySelector('.followers-list');

    function createPostElement(post) {
      const postElement = document.createElement('div');
      postElement.classList.add('post');

      postElement.addEventListener("click", ()=>postClick(post))
      const formattedDate = new Date(post.timestamp).toLocaleString();

      postElement.innerHTML = `
        <div class="post-header">
          <div class="post-author">
          <img class="creator-avatar" src="${post.creator.avatar}" alt="${post.creator.name}'s avatar">
          <span class="creator-name">${post.creator.name}</span>
          </div>
          <span class="post-timestamp">${formattedDate}</span>
        </div>
        <div class="post-content">
          <p>${post.content}</p>
          ${post.image ? `<img class="post-image" src="${post.image}" alt="Post image">` : ''}
        </div>
        <div class="post-actions hidden">
          <button class="action-btn like-btn">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
              <path d="M8 2.748l-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z"/>
            </svg>
            ${post.likes}
          </button>
          <button class="action-btn comment-btn">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
              <path d="M14 1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1h-2.5a2 2 0 0 0-1.6.8L8 14.333 6.1 11.8a2 2 0 0 0-1.6-.8H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h2.5a1 1 0 0 1 .8.4l1.9 2.533a1 1 0 0 0 1.6 0l1.9-2.533a1 1 0 0 1 .8-.4H14a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
            </svg>
            ${post.comments}
          </button>
          <span class="token-price">${post.price} EXDC</span>
        </div>
      `;

      return postElement;
    }

    function postClick(post) {
      console.info('clicked on post', post)
      window.location.pathname = "/creator"
    }

    function chatClick(chat) {
      console.info('clicked on chat', chat)
      window.location.pathname = "/creator"
    }

    function createChatElement(chat) {
      const chatElement = document.createElement('li');
      chatElement.classList.add('chat-item');
      
      chatElement.addEventListener("click", ()=>chatClick(chat))

      chatElement.innerHTML = `
        <img class="chat-avatar" src="${chat.avatar}" alt="${chat.name}'s avatar">
        <div class="hidden-on-mobile">
          <div class="chat-name">${chat.name}</div>
          <div class="chat-preview">${chat.lastMessage}</div>
        </div>
      `;
      return chatElement;
    }

    function createFollowerElement(follower) {
      const followerElement = document.createElement('li');
      followerElement.classList.add('follower-item');
      followerElement.innerHTML = `
        <img class="follower-avatar" src="${follower.avatar}" alt="${follower.name}'s avatar">
        <div class="follower-name">${follower.name}</div>
      `;
      return followerElement;
    }

    posts.forEach(post => {
      const postElement = createPostElement(post);
      timeline.appendChild(postElement);
    });

    chats.forEach(chat => {
      const chatElement = createChatElement(chat);
      chatList.appendChild(chatElement);
    });

    followers.forEach(follower => {
      const followerElement = createFollowerElement(follower);
      followersList.appendChild(followerElement);
    });


    // Web3 integration
    window.addEventListener('load', async () => {
      if (window.ethereum) {
        window.web3 = new Web3(ethereum);
        try {
          await ethereum.enable();
          console.log("Web3 initialized!");
        } catch (error) {
          console.error("User denied account access");
        }
      } else if (window.web3) {
        window.web3 = new Web3(web3.currentProvider);
        console.log("Web3 initialized!");
      } else {
        console.log('Non-Ethereum browser detected. Consider trying MetaMask!');
      }
    });
  </script>
</body></html>